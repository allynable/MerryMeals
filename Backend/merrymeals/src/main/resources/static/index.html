<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Facebook Login API</title>
    <style>
      #map {
        height: 600px;
        width: 600px;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBeP41nTw8QroOfvcCFR9bKIC-GUW7BLcs"></script>
    <script>
      function initAutocomplete() {
        var addressInput = document.getElementById("address");
        var autocompleteService = new google.maps.places.AutocompleteService();
        var suggestionsContainer = document.getElementById("suggestions");

        addressInput.addEventListener("input", function () {
          var input = addressInput.value;

          if (input) {
            autocompleteService.getPlacePredictions(
              { input: input },
              function (results, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                  suggestionsContainer.innerHTML = "";
                  results.forEach(function (prediction) {
                    var suggestion = document.createElement("div");
                    suggestion.textContent = prediction.description;
                    suggestion.classList.add("suggestion");
                    suggestion.addEventListener("click", function () {
                      addressInput.value = prediction.description;
                      suggestionsContainer.innerHTML = "";
                      geocodeAddress();
                    });
                    suggestionsContainer.appendChild(suggestion);
                  });
                } else {
                  suggestionsContainer.innerHTML = "";
                }
              }
            );
          } else {
            suggestionsContainer.innerHTML = "";
          }
        });
      }

      function geocodeAddress() {
        var geocoder = new google.maps.Geocoder();
        var address = document.getElementById("address").value;

        geocoder.geocode({ address: address }, function (results, status) {
          if (status === "OK") {
            var location = results[0].geometry.location;
            var latitude = location.lat();
            var longitude = location.lng();

            document.getElementById("latitude").value = latitude;
            document.getElementById("longitude").value = longitude;
          } else {
            alert(
              "Geocode was not successful for the following reason: " + status
            );
          }
        });
      }

      function reverseGeocodeAddress() {
        var geocoder = new google.maps.Geocoder();
        var latitude = parseFloat(document.getElementById('latitude').value);
        var longitude = parseFloat(document.getElementById('longitude').value);

        if (isNaN(latitude) || isNaN(longitude)) {
          alert('Please enter valid coordinates.');
          return;
        }

        var location = new google.maps.LatLng(latitude, longitude);

        geocoder.geocode({ location: location }, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              var formattedAddress = results[0].formatted_address;
              var modifiedAddress = formattedAddress.replace(/\s\w+\+\w+/g, '');

              document.getElementById('address').value = modifiedAddress;

              console.log(results);
            } else {
              alert('No results found.');
            }
          } else {
            alert('Geocoder failed due to: ' + status);
          }
        });
      }
    </script>
    </script>
  </head>
  <body>
    <!-- <h1>Facebook Login API Demo</h1>
    <div class="container unauthenticated">
      <a href="/login">
        <button type="button" class="btn btn-primary">
          Login with Facebook
        </button>
      </a>
    </div>
    <div class="container authenticated" style="display: none">
      Logged in as: <span id="user"></span>
      <button onClick="logout()" class="btn btn-danger">Logout</button>
    </div> -->

    <h1>Maps</h1>
    <div id="map"></div>
    <div>
      <form>
        <label for="address">Address:</label>
        <input type="text" id="address" name="address" autocomplete="off" />
        <div id="suggestions"></div>
        <button type="button" onclick="geocodeAddress()">Geocode</button>
        <button type="button" onclick="reverseGeocodeAddress()">Reverse Geocode</button>
      </form>

      <div>
        <label for="latitude">Latitude:</label>
        <input type="text" id="latitude"/>

        <label for="longitude">Longitude:</label>
        <input type="text" id="longitude" />
      </div>
    </div>
    <script>
      function initMap() {
        var singapore = { lat: 1.3521, lng: 103.8198 };
        var map = new google.maps.Map(document.getElementById("map"), {
          zoom: 12,
          center: singapore,
        });

        // Add markers from service center repository
        var serviceCenters = [
          { lat: 1.3057, lng: 103.854662, name: "Service Center 1" },
          { lat: 1.317464, lng: 103.852855, name: "Service Center 2" },
          // Add more service centers as needed
        ];

        serviceCenters.forEach(function (serviceCenter) {
          var marker = new google.maps.Marker({
            position: {
              lat: parseFloat(serviceCenter.lat),
              lng: parseFloat(serviceCenter.lng),
            },
            map: map,
            title: serviceCenter.name,
          });
        });
      }

      initAutocomplete();
    </script>
    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBeP41nTw8QroOfvcCFR9bKIC-GUW7BLcs&callback=initMap"
    ></script>
  </body>
</html>
